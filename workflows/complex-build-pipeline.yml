# complex-build-pipeline.yml - Example complex build pipeline
# This demonstrates conditional execution and output capture
#
# Usage: mmm cook examples/complex-build-pipeline.yml

# Check compilation first
- shell: "cargo check"
  on_success:
    shell: "cargo build --release"
    on_success:
      shell: "cargo test --release"
      on_failure:
        claude: "/prodigy-debug-and-fix '${shell.output}'"
        
# Run clippy and fix any issues
- shell: "cargo clippy -- -D warnings"
  capture_output: "clippy_warnings"
  on_failure:
    claude: "/prodigy-fix-clippy-warnings '${clippy_warnings}'"
    
# Run benchmarks if all tests pass
- shell: "cargo bench"
  timeout: 600  # 10 minutes
  capture_output: "benchmark_results"
  on_exit_code:
    0:
      shell: "echo 'Benchmarks completed successfully!'"
    101:
      claude: "/prodigy-fix-compilation-errors '${benchmark_results}'"