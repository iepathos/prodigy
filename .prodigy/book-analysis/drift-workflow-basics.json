{
  "item_type": "chapter",
  "chapter_id": "workflow-basics",
  "chapter_title": "Workflow Basics",
  "chapter_file": "book/src/workflow-basics.md",
  "drift_detected": true,
  "severity": "medium",
  "quality_assessment": "Chapter is comprehensive and well-structured with accurate code examples. Main issues are broken internal links to non-existent files. The chapter references files that should exist but are missing, breaking navigation. Content itself is accurate and matches implementation.",
  "issues": [
    {
      "type": "broken_links",
      "severity": "medium",
      "section": "Cross-References and Next Steps",
      "description": "Found 7 broken internal links referencing non-existent files",
      "broken_links": [
        {
          "link_text": "Claude Integration",
          "link_target": "./claude-integration.md",
          "expected_file": "book/src/claude-integration.md",
          "current_file": "book/src/workflow-basics.md",
          "line_references": [138, 887]
        },
        {
          "link_text": "Variable Reference",
          "link_target": "./variables-and-interpolation.md",
          "expected_file": "book/src/variables-and-interpolation.md",
          "current_file": "book/src/workflow-basics.md",
          "line_references": [464]
        },
        {
          "link_text": "Environment Variables",
          "link_target": "./environment-variables.md",
          "expected_file": "book/src/environment-variables.md",
          "current_file": "book/src/workflow-basics.md",
          "line_references": [541, 886]
        },
        {
          "link_text": "Merge Workflows",
          "link_target": "./merge-workflows.md",
          "expected_file": "book/src/merge-workflows.md",
          "current_file": "book/src/workflow-basics.md",
          "line_references": [653]
        },
        {
          "link_text": "Checkpoint and Resume",
          "link_target": "./checkpoint-and-resume.md",
          "expected_file": "book/src/checkpoint-and-resume.md",
          "current_file": "book/src/workflow-basics.md",
          "line_references": [708]
        },
        {
          "link_text": "MapReduce Workflows",
          "link_target": "./mapreduce-overview.md",
          "expected_file": "book/src/mapreduce-overview.md",
          "current_file": "book/src/workflow-basics.md",
          "line_references": [883]
        },
        {
          "link_text": "Output Capture",
          "link_target": "./output-capture.md",
          "expected_file": "book/src/output-capture.md",
          "current_file": "book/src/workflow-basics.md",
          "line_references": [885]
        }
      ],
      "fix_suggestion": "Update all broken links to point to existing files in subdirectories or create the missing files. Likely these should point to subdirectory index files:\n- ./claude-integration.md → (needs creation or link to relevant section)\n- ./variables-and-interpolation.md → ./variables/index.md\n- ./environment-variables.md → ./environment/index.md or ./configuration/environment-variables.md\n- ./merge-workflows.md → ./workflow-basics/merge-workflows.md\n- ./checkpoint-and-resume.md → ./mapreduce/checkpoint-and-resume.md\n- ./mapreduce-overview.md → ./mapreduce/index.md\n- ./output-capture.md → ./variables/custom-variable-capture.md (or needs creation)",
      "validation_required": true
    },
    {
      "type": "missing_content",
      "severity": "low",
      "section": "Command Types - Validate Commands",
      "description": "Documentation shows 'validate:' as a command type but implementation shows it's a field on WorkflowStepCommand, not a standalone command type",
      "current_content": "Lines 177-214 document validate: as if it's a command type like shell: or claude:",
      "should_be": "validate: is a field that can be added to any command for validation, particularly used with goal_seek",
      "fix_suggestion": "Clarify that 'validate' is not a standalone command type but a configuration field. Move to 'Step-Level Configuration' section or clarify in context of goal_seek.",
      "source_reference": "src/config/command.rs:379-380"
    },
    {
      "type": "incomplete_explanation",
      "severity": "low",
      "section": "Command Types - Foreach Commands",
      "description": "Documentation doesn't explain the 'do' field must be wrapped in 'do_block' internally due to Rust keyword restrictions",
      "fix_suggestion": "Add note that while YAML uses 'do:', the internal representation uses 'do_block' to avoid Rust keyword conflicts. Users should use 'do:' in YAML.",
      "source_reference": "src/config/command.rs:200-202"
    },
    {
      "type": "unclear_content",
      "severity": "low",
      "section": "Step-Level Configuration - Output Capture",
      "description": "Documentation shows both 'capture' and 'capture_output' without clearly distinguishing between them",
      "current_content": "Lines 562-576 show both 'capture: commit_hash' and 'capture_output: test_results'",
      "should_be": "Clarify that 'capture' is the simple form and 'capture_output' is the field name with advanced options (format, streams)",
      "fix_suggestion": "Add explicit note: \"Note: 'capture' is shorthand for 'capture_output' with default settings. Use 'capture_output' for advanced configuration with 'capture_format' and 'capture_streams'.\"",
      "source_reference": "src/config/command.rs:366-396"
    }
  ],
  "positive_aspects": [
    "Excellent progression from simple to complex (Simple Array → Full Configuration → Legacy)",
    "Comprehensive command type reference table with source code references",
    "Real-world examples from actual workflow files",
    "Clear explanation of sequential execution model",
    "Well-documented variable interpolation with both ${VAR} and $VAR syntaxes",
    "Good troubleshooting section with common issues and solutions",
    "Best practices section with actionable advice",
    "Accurate source code references throughout (e.g., src/config/command.rs:319-380)",
    "Clear examples of worktree isolation benefits and verification"
  ],
  "improvement_suggestions": [
    "Fix all broken internal links to point to existing documentation",
    "Add a note about 'capture' vs 'capture_output' distinction",
    "Clarify that 'validate' is a field, not a standalone command type",
    "Consider adding a 'File Structure' section explaining the subdirectory organization",
    "Add cross-references to the workflow-basics/ subdirectory for detailed explanations"
  ],
  "metadata": {
    "analyzed_at": "2025-01-11T01:20:00Z",
    "feature_inventory": "Code-based analysis (no features.json provided)",
    "topics_covered": [
      "Standard workflows",
      "Basic structure",
      "Command execution",
      "Command types (shell, claude, write_file, goal_seek, foreach, validate)",
      "Variable interpolation",
      "Environment configuration",
      "Worktree isolation",
      "Merge workflows",
      "Error handling"
    ],
    "validation_focus": "Check basic workflow syntax and structure documentation"
  }
}
