{
  "item_type": "subsection",
  "chapter_id": "mapreduce",
  "subsection_id": "dead-letter-queue-dlq",
  "subsection_title": "Dead Letter Queue (DLQ)",
  "subsection_file": "book/src/mapreduce/dead-letter-queue-dlq.md",
  "feature_mappings": [
    "mapreduce.dlq",
    "error_handling.dlq"
  ],
  "drift_detected": true,
  "severity": "medium",
  "quality_assessment": "Documentation is comprehensive and mostly accurate, with excellent structure coverage. However, it has 3 broken cross-reference links that will cause mdbook build failures. The max_retries default value is incorrect (shows 3, should be 2). Overall content quality is strong with good examples and debugging workflows.",
  "issues": [
    {
      "type": "broken_links",
      "severity": "medium",
      "section": "Cross-References",
      "description": "Found 3 broken internal link(s) that will cause mdbook build failures",
      "broken_links": [
        {
          "link_text": "Claude Command Observability",
          "target": "../debugging/claude-command-observability.md",
          "expected_path": "book/src/debugging/claude-command-observability.md",
          "status": "File does not exist",
          "suggestion": "The debugging chapter appears to have been migrated or reorganized. Search for claude-command-observability content or create the debugging chapter structure."
        },
        {
          "link_text": "Error Handling",
          "target": "./error-handling.md",
          "expected_path": "book/src/mapreduce/error-handling.md",
          "status": "File does not exist",
          "actual_location": "book/src/error-handling.md",
          "suggestion": "Update link to '../error-handling.md' (chapter is at book root, not in mapreduce subdirectory)"
        },
        {
          "link_text": "Worktree Architecture",
          "target": "./worktree-architecture.md",
          "expected_path": "book/src/mapreduce/worktree-architecture.md",
          "status": "File does not exist",
          "actual_location": "book/src/mapreduce-worktree-architecture.md",
          "suggestion": "Update link to '../mapreduce-worktree-architecture.md' (chapter is at book root with different naming)"
        }
      ],
      "fix_suggestion": "Update broken links:\n1. '../debugging/claude-command-observability.md' → needs investigation or removal\n2. './error-handling.md' → '../error-handling.md'\n3. './worktree-architecture.md' → '../mapreduce-worktree-architecture.md'",
      "source_reference": "book/src/mapreduce/dead-letter-queue-dlq.md (lines 124, 350, 495-498)"
    },
    {
      "type": "missing_content",
      "severity": "low",
      "section": "DLQ Commands - Retry",
      "description": "Default value for --max-retries is incorrect",
      "current_content": "Documentation shows 'default: 3' for --max-retries parameter",
      "should_be": "default: 2",
      "fix_suggestion": "Update documentation to match CLI implementation: change 'default: 3' to 'default: 2' in retry command description (line 252)",
      "source_reference": "src/cli/args.rs:267-268"
    }
  ],
  "positive_aspects": [
    "Comprehensive coverage of DLQ data structures with accurate field-by-field documentation",
    "Clear explanation of storage architecture and global storage benefits",
    "Good distinction between stub commands and implemented functionality with prominent warnings",
    "Excellent debugging workflow examples with practical commands",
    "Accurate documentation of ErrorType enum and all variants",
    "Well-documented DeadLetteredItem and FailureDetail structures match implementation exactly",
    "Good integration examples showing how DLQ fits into MapReduce workflows",
    "Helpful troubleshooting section with common scenarios",
    "Storage structure accurately reflects implementation (GlobalStorage + DLQStorage nesting)",
    "json_log_location field properly documented with cross-reference to Claude observability"
  ],
  "improvement_suggestions": [
    "Fix broken cross-reference links to prevent mdbook build failures (CRITICAL)",
    "Correct max_retries default value from 3 to 2 to match implementation",
    "Consider adding example of actual DLQ JSON file content from real execution",
    "Add link to retry-metrics-and-observability.md section for additional observability context",
    "Consider adding note about DLQ performance characteristics (memory usage, disk space)",
    "Add troubleshooting section for broken links and missing referenced chapters"
  ],
  "cross_references": [
    "checkpoint-and-resume",
    "event-tracking",
    "error-handling (BROKEN - needs '../error-handling.md')",
    "mapreduce-worktree-architecture (BROKEN - needs '../mapreduce-worktree-architecture.md')",
    "claude-command-observability (BROKEN - debugging chapter missing)"
  ],
  "link_validation": {
    "broken_links": [
      {
        "target": "../debugging/claude-command-observability.md",
        "expected": "book/src/debugging/claude-command-observability.md",
        "status": "missing"
      },
      {
        "target": "./error-handling.md",
        "expected": "book/src/mapreduce/error-handling.md",
        "actual": "book/src/error-handling.md",
        "status": "incorrect_path"
      },
      {
        "target": "./worktree-architecture.md",
        "expected": "book/src/mapreduce/worktree-architecture.md",
        "actual": "book/src/mapreduce-worktree-architecture.md",
        "status": "incorrect_path"
      }
    ],
    "validation_passed": false,
    "notes": "3 broken internal links will cause mdbook build failures. Two can be fixed by updating paths, one requires investigating debugging chapter structure."
  },
  "metadata": {
    "analyzed_at": "2025-01-11T10:45:00Z",
    "feature_inventory": ".prodigy/book-analysis/features.json",
    "topics_covered": [
      "DLQ structure",
      "failed item storage",
      "retry commands",
      "debugging",
      "error types",
      "storage architecture",
      "failure analysis"
    ],
    "validation_focus": "Check DLQ structure and retry commands documented",
    "source_files_referenced": [
      "src/cook/execution/dlq.rs",
      "src/cli/commands/dlq.rs",
      "src/cli/args.rs",
      "src/storage/global.rs"
    ],
    "critical_findings": [
      "3 broken cross-reference links will cause mdbook build to fail",
      "max_retries default value mismatch (doc: 3, actual: 2)"
    ]
  }
}
