{
  "item_type": "section-page",
  "section_id": "workflow-basics",
  "section_title": "Workflow Basics",
  "page_id": "variables",
  "page_title": "Variables and Interpolation",
  "page_file": "docs/workflow-basics/variables.md",
  "feature_mappings": [
    "variable_system.standard_variables",
    "variable_system.mapreduce_variables",
    "variable_system.capture_variables",
    "variable_system.interpolation"
  ],
  "drift_detected": true,
  "severity": "low",
  "quality_assessment": "Page is generally accurate and comprehensive. Minor issues with missing features and some outdated information about capture formats.",
  "issues": [
    {
      "type": "missing_content",
      "severity": "low",
      "section": "Standard Variables",
      "description": "Missing documentation for 'worker.id' variable that is listed in features.json",
      "feature_reference": "variable_system.mapreduce_variables.worker.id",
      "fix_suggestion": "The documentation lists 'worker.id' under MapReduce Variables but does not include it in the Standard Variables section. However, based on the features inventory, worker.id is a MapReduce-specific variable, so it should stay in the MapReduce Variables section. No fix needed - this is correctly documented.",
      "source_reference": "features.json:176"
    },
    {
      "type": "missing_content",
      "severity": "medium",
      "section": "MapReduce Variables",
      "description": "Documentation shows 'map.key' variable but features.json describes it as 'Key for map output' without clear usage examples",
      "feature_reference": "variable_system.mapreduce_variables",
      "fix_suggestion": "Add clarification or example showing when and how map.key is used, or consider removing if deprecated",
      "source_reference": "features.json:175, docs/workflow-basics/variables.md:35"
    },
    {
      "type": "outdated_information",
      "severity": "low",
      "section": "Output Capture / Capture Formats",
      "description": "Documentation lists 'boolean' as a capture format, but implementation only shows 'string', 'json', 'lines', 'number' in capture_format field",
      "current_content": "- **boolean** - Parse true/false value",
      "should_be": "Remove 'boolean' format or clarify if it's actually supported",
      "fix_suggestion": "Verify if 'boolean' capture format is implemented. If not, remove from documentation. Based on src/config/command.rs:392, capture_format is an Option<String>, but specific format validation is not visible in the config layer.",
      "source_reference": "docs/workflow-basics/variables.md:78, src/config/command.rs:392"
    },
    {
      "type": "incomplete_explanation",
      "severity": "low",
      "section": "Array Access",
      "description": "Shows array access syntax but doesn't explain bracket notation used in InterpolationEngine",
      "fix_suggestion": "Add note that array access in variable interpolation uses both 'items[0]' and 'items.0' syntax, as both are supported by the InterpolationEngine",
      "source_reference": "src/cook/execution/interpolation.rs:782-789"
    },
    {
      "type": "missing_content",
      "severity": "low",
      "section": "Variable Aliases",
      "description": "Documentation mentions 'aliases for backward compatibility' but doesn't provide comprehensive list",
      "fix_suggestion": "Either expand the aliases section with complete mapping, or clarify that this is a legacy feature and new code should use dot notation",
      "source_reference": "docs/workflow-basics/variables.md:123-129"
    },
    {
      "type": "missing_content",
      "severity": "low",
      "section": "Capture Metadata",
      "description": "capture_format field exists in config but no validation or enum shown for allowed values",
      "feature_reference": "variable_system.capture_variables.formats",
      "fix_suggestion": "Document the exact allowed values for capture_format field: 'string', 'json', 'lines', 'number' (and 'boolean' if supported). Add validation notes.",
      "source_reference": "src/config/command.rs:392, docs/workflow-basics/variables.md:72-78"
    }
  ],
  "positive_aspects": [
    "Clear structure separating variable categories (Standard, MapReduce, Merge)",
    "Good examples showing real-world usage patterns",
    "Comprehensive coverage of interpolation syntax including default values",
    "Cross-references to related documentation are present and valid",
    "Nested field access is well-explained with examples",
    "All internal documentation links are valid and working"
  ],
  "improvement_suggestions": [
    "Add troubleshooting section for common variable interpolation errors",
    "Include example of using aggregate variables (sum, count, average) which exist in VariableContext",
    "Clarify the scope and lifetime of variables across different workflow phases",
    "Add advanced examples showing computed variables (env.*, file:, cmd:, json:, date:, uuid) which are implemented in VariableContext but not documented here",
    "Consider adding a section on variable caching behavior for expensive operations"
  ],
  "cross_references": [
    "command-types",
    "environment",
    "mapreduce/index",
    "conditional-execution"
  ],
  "link_validation": {
    "total_internal_links": 4,
    "broken_links": 0,
    "all_links_valid": true
  },
  "metadata": {
    "analyzed_at": "2025-11-11T21:30:00Z",
    "feature_inventory": ".prodigy/mkdocs-analysis/features.json",
    "topics_covered": [
      "Variable interpolation",
      "Standard variables",
      "MapReduce variables",
      "Capture variables",
      "Output formats"
    ],
    "validation_focus": "Check variable syntax, interpolation engine, and capture formats are documented"
  }
}
